stages:
  - test
  - publish

test:
  stage: test
  image: mhart/alpine-node:8
  script:
    - echo 1
  tags:
    - sl-frontend

publish:
  stage: publish
  image: mhart/alpine-node:8
  before_script:
    - echo //gitlab.sima-land.ru/api/v4/projects/625/packages/npm/:_authToken=${NPM_AUTH_TOKEN} > .npmrc
  script:
    - npm version $CI_COMMIT_REF_NAME && npm publish
  only:
    refs:
      - tags
  tags:
    - sl-frontend